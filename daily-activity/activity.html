<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Activity Glacial Pro | Hexindo Fleet</title>
    
    <script>
        if (localStorage.getItem('isLoggedIn') !== 'true') {
            window.location.replace('../login.html');
        }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.autotable.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <canvas id="snow-canvas"></canvas>

    <div id="splash-screen">
        <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"></div>
        <p class="mt-6 font-black text-white text-[10px] tracking-[0.3em] uppercase italic">Optimizing NIK Terminal...</p>
    </div>

    <div id="scaler-context" class="space-y-4">
        
        <header class="glass-ice p-5 rounded-[2.5rem] flex justify-between items-center no-print gap-3">
            <div class="flex items-center gap-3">
                <a href="../index.html" class="h-10 w-10 bg-white/20 rounded-xl flex items-center justify-center text-white shadow-sm border border-white/10 hover:bg-white/30 transition-all">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
                </a>
                <div>
                    <h1 class="text-lg font-black italic text-white leading-none tracking-tighter uppercase">ACTIVITY <span class="text-blue-200">REPORT</span></h1>
                    <p class="text-[8px] font-black text-blue-100 tracking-widest uppercase mt-1">Status: NIK Secured</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button onclick="pullFromCloud()" class="bg-white/10 text-blue-200 px-3 py-2 rounded-lg font-bold text-[9px] uppercase border border-white/10">üîÑ Pull</button>
                <button onclick="syncToCloud()" id="btnSync" class="bg-blue-500 text-white px-4 py-2 rounded-lg font-bold text-[9px] uppercase shadow-lg hover:bg-blue-400 transition-all">‚ùÑÔ∏è Sync</button>
                <button onclick="exportToPDF()" class="bg-white/5 text-slate-300 px-3 py-2 rounded-lg font-bold text-[9px] uppercase border border-white/10">üìÑ PDF</button>
                <button onclick="exportToExcel()" class="bg-emerald-600 text-white px-3 py-2 rounded-lg font-bold text-[9px] uppercase border border-emerald-700">üìä Excel</button>
            </div>
        </header>

        <div class="glass-ice p-6 rounded-[3rem] no-print">
            <input type="hidden" id="editId">
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div>
                    <label class="header-label">Technician & NIK</label>
                    <div class="flex gap-2">
                        <input type="text" id="nameInp" class="header-val opacity-70" readonly>
                        <input type="text" id="nikInp" class="header-val w-28 text-center font-mono opacity-70" readonly>
                    </div>
                </div>
                <div><label class="header-label">Date</label><input type="date" id="dateInp" class="header-val"></div>
                <div><label class="header-label">Customer</label><input type="text" id="customerInp" class="header-val" placeholder="PT ADARO"></div>
                <div><label class="header-label">Location</label><input type="text" id="locationInp" class="header-val" placeholder="NORTH"></div>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div><label class="header-label">Model</label><input type="text" id="modelInp" class="header-val text-blue-300" placeholder="EX3600-6"></div>
                <div><label class="header-label">S/N</label><input type="text" id="snInp" class="header-val" placeholder="SN12345"></div>
                <div><label class="header-label">HM</label><input type="number" step="0.1" id="hmInp" class="header-val" placeholder="0.0"></div>
                <div><label class="header-label">General Job</label><input type="text" id="jobDescInp" class="header-val" placeholder="OVERHAUL"></div>
            </div>

            <div id="detailRowsContainer" class="space-y-3 mb-6"></div>
            
            <div class="flex flex-col gap-3">
                <button onclick="smartAddTask()" class="bg-white/5 text-blue-200 px-6 py-3 rounded-[1.2rem] font-black text-[10px] uppercase border border-white/10 hover:bg-white/10 transition-all">+ Add Progress</button>
                <button id="submitBtn" onclick="submitLog()" class="bg-blue-500 text-white font-black py-4 rounded-[1.2rem] uppercase text-[10px] tracking-[0.3em] shadow-xl hover:bg-blue-400 transition-all">Authorize & Submit</button>
            </div>
        </div>

        <div id="masterList" class="space-y-6 pb-16"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>
